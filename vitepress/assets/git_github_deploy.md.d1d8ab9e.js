import{_ as s,o as n,c as a,V as l}from"./chunks/framework.716eacd7.js";const p="/vitepress/assets/deploy-error.7ca8b9f7.png",e="/vitepress/assets/settings-actions.df46c0ef.png",F=JSON.parse('{"title":"VitePress Github Deploy","description":"","frontmatter":{},"headers":[],"relativePath":"git/github/deploy.md","lastUpdated":1683186045000}'),o={name:"git/github/deploy.md"},t=l(`<h1 id="vitepress-github-deploy" tabindex="-1">VitePress Github Deploy <a class="header-anchor" href="#vitepress-github-deploy" aria-label="Permalink to &quot;VitePress Github Deploy&quot;">​</a></h1><div class="language-yml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Deploy VitePress Docs</span></span>
<span class="line"><span style="color:#D19A66;">on</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">workflow_dispatch</span><span style="color:#ABB2BF;">: {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># master 发生 push 时触发部署</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">push</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">branches</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#98C379;">vitepress</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">jobs</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">build-and-deploy</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Deploy VitePress Docs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 指定运行机器</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">runs-on</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">ubuntu-latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 执行步骤</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">steps</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 检出仓库</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">git checkout &amp; git pull</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">uses</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">actions/checkout@v3</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#https://github.com/actions/checkout</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">with</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">fetch-depth</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 安装 Node.js</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Install Node.js</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">uses</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">actions/setup-node@v3</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#https://github.com/actions/setup-node</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">with</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">node-version</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;16.19.0&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">cache</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">npm</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">cache-dependency-path</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">./vitepress</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 安装依赖</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Install dependencies</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">run</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">cd ./vitepress &amp;&amp; npm ci</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 构建文档</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Build</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">run</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">cd ./vitepress &amp;&amp; npm run docs:build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 部署到 GitHub Pages</span></span>
<span class="line"><span style="color:#ABB2BF;">            - </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Deploy to GitHub Pages</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">uses</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">peaceiris/actions-gh-pages@v3</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># https://github.com/peaceiris/actions-gh-pages</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">with</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">personal_token</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">\${{ secrets.GITHUB_TOKEN }}</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">publish_branch</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">gh-pages</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">publish_dir</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">./vitepress/docs/.vitepress/dist</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">destination_dir</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">./vitepress</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">keep_files</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h4 id="在-deploy-to-github-pages-时出现-permission-to-xxx-git-denied-to-github-actions-bot-的错误" tabindex="-1">在 <code>Deploy to GitHub Pages</code> 时出现 <code>Permission to XXX.git denied to github-actions[bot].</code> 的错误 <a class="header-anchor" href="#在-deploy-to-github-pages-时出现-permission-to-xxx-git-denied-to-github-actions-bot-的错误" aria-label="Permalink to &quot;在 \`Deploy to GitHub Pages\` 时出现 \`Permission to XXX.git denied to github-actions[bot].\` 的错误&quot;">​</a></h4><p><img src="`+p+'" alt="deploy-error"></p><details class="details custom-block"><summary>解决方法</summary><p>在 github 当前项目的仓库中，进入 <code>Settings &gt; Actions &gt; General</code> 目录下</p><ol><li>将 <code>Workflow permissions</code> 下的 <code>default permissions granted</code> 设置为 <code>Read and write permissions</code></li><li>勾选 <code>Allow GitHub Actions to create and approve pull requests</code><img src="'+e+'" alt="Settings &gt; Actions &gt; General"></li></ol></details>',5),c=[t];function r(i,B,y,b,u,m){return n(),a("div",null,c)}const A=s(o,[["render",r]]);export{F as __pageData,A as default};
